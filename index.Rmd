---
title:  'Computational Musicology'
author: 'Dewi Boessen'
date:   'February--March 2020'
output: 
    flexdashboard::flex_dashboard:
        storyboard: true
        theme: simplex
---

```{r setup}
# In order to use these packages, we need to install flexdashboard, plotly, and Cairo.
library(tidyverse)
library(plotly)
library(spotifyr)
source('spotify.R')
```

### Introduction

I would like to compare Dutch Carnivals music to today's top hits. I think this is interesting because, in my opinion, carnavals music always gets people in a good mood. I also think it's interesting because the genres, subjects and even the vibes are very different. A lot of people can sing the songs in both the lists along (maybe only the people that live in the south of the Netherlands can sing along with the carnival music though). I'm very curious to see what's the difference between the two.

For my corpus, I used two Spotify playlist, Vasteloavend 2020 and Today's Top Hits. Both the playlist consist of songs that are currently most popular. As measured by Spotify, carnivals music has a much higher valence (M = 0.768, SD = 0.195) than the top hits (M = 0.495, SD = 0.208). The mode of carinals music, overall, seems to be more major (M = 0.963, SD = 0.189) than the top hits (M = 0.54, SD = 0.503).

The carnival music also has a much higher energy (M = 0.792, SD = 0.120), compared to the hits (M = 0.587, SD = 0.158). Interesting to see is that the liveness of today's hits (M = 1.73, SD = 0.142) is much higher than the carnival music (M = 0.222, SD = 0.161). I think these findings are also something to look into, because maybe it is possible to find a reason for it.

I wanted to see whether or not Limburgish carnival music is very different from the music in Brabant. The two playlists I used are Vastelaovend 2020 and Carnaval 2020 hits. I found that this isn't the case, so I decided to use them both. The only thing that's different is the mode. In Limburg, the music's much more major (M = 0.944, SD = 0.232), while in Brabant the difference is much greater (M = 0.683, SD = 0.467). Here, it is interesting to see that the standard deviation is very big. Because the music isn't that different from each other, I'm going to use them both.

***

This is a second column of introductory text.


### Carnaval Music Is More Positive

```{r}

limburg <- get_playlist_audio_features('Henk Theunissen', '1xQvcNKQVMGOsuZK6nXx9a')
brabant <- get_playlist_audio_features('Sander van Berkel', '4rghKMRumKCenvOxbmjwmL')

carnaval <-
  limburg %>% mutate(playlist = "Limburg") %>%
  bind_rows(brabant %>% mutate(playlist = "Brabant"))

todayshits <- get_playlist_audio_features('Soave', '5iKY71w39zY0Bs6kcmOK2Z')

muziek <- carnaval %>% mutate(playlist = "Carnaval") %>% bind_rows(todayshits %>% mutate(playlist = "Hits in Nederland 2020"))


vergelijking <- muziek %>%                       # Start with awards.
  mutate(
    mode = ifelse(mode == 0, 'Minor', 'Major')
  ) %>%
  ggplot(                      # Set up the plot.
    aes(
      x = valence,
      y = energy,
      size = loudness,
      colour = mode
    )
  ) +
  geom_point() +               # Scatter plot.
  geom_rug(size = 0.1) +       # Add 'fringes' to show data distribution.
  facet_wrap(~ playlist) +     # Separate charts per playlist.
  scale_x_continuous(          # Fine-tune the x axis.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),  # Use grid-lines for quadrants only.
    minor_breaks = NULL      # Remove 'minor' grid-lines.
  ) +
  scale_y_continuous(          # Fine-tune the y axis in the same way.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),
    minor_breaks = NULL
  ) +
  scale_colour_brewer(         # Use the Color Brewer to choose a palette.
    type = "qual",           # Qualitative set.
    palette = "Reds"       # Name of the palette is 'Paired'.
  ) +
  scale_size_continuous(       # Fine-tune the sizes of each point.
    trans = "exp",           # Use an exp transformation to emphasise loud.
    guide = "none"           # Remove the legend for size.
  ) +
  theme_light() +              # Use a simpler them.
  labs(                        # Make the titles nice.
    x = "Valence",
    y = "Energy",
    colour = "Mode"
  )

ggplotly(vergelijking)

```

***

As you can see, the hitsongs in the Netherlands are more spread over both the axis. The carnival music tends to have a very high energy and a high valence. Ofcourse, there are some outliers.

For this visualisation from Week 7, I took playlists of the pop music presented at the Grammy awards (US) and the Edison awards (NL) in 2019. Using `ggplotly`, the visualisation became interactive.

The *x* axis shows valence and the *y* axis shows Spotify's ‘energy’ feature, which is roughly analogous to the notion of arousal in psychological research on emotion. Under this model, the quadrants of each graph, starting clockwise from the top left, represent angry, happy, relaxed, and sad music. The size of each point is proportional to the average volume of the track.

The visualisation shows that in 2019, the pop music at the Grammys was (according to Spotify) rather angrier and rather louder than the music at the Edisons.
